<%= render GovGridRowComponent.new(additional_classes: "community-activity-grid-wrapper") do |row| %>
  <%= row.with_column(:full) do %>
    <div class="community-activity-grid">
      <% if @title %>
        <h2 class="govuk-heading-m"><%= @title %></h2>
      <% end %>

      <%= render @intro.render if @intro %>

      <div data-controller="cms--community-activity-grid-component"
        data-cms--community-activity-grid-component-create-path-value="<%= achievements_path %>">
        <%= render ModalComponent.new(title: "Activity added to dashboard",
          show_corner_decoration: false,
          data: { 
            action: "cms--community-activity-grid-component:selected@window->modal#openWithText"
          }) do |modal| %> 
          <%= modal.with_body do %>
            <div class="community-activity-grid__modal-content">
              <h3 class="govuk-heading-s" data-cms--community-activity-grid-component-target="activityTitle"></h3>
              <p class="govuk-body-m">Complete this activity to achieve Step <%= "two" %> of the <%= @programme.title %> </p>
              <div class="button-container">
                <%= link_to "Visit my dashboard", @programme.path, class: "govuk-button button" %>
              </div>
            </div>
          <% end %>
        <% end %>
        <div class="community-activity-grid__grid">
          <% @started_activities.each do |activity| %>
            <div class="community-activity-grid__grid-activity community-activity-grid__grid-activity--started">
              <div class="activity-started">
                <span class="govuk-heading-s">ACTIVITY ADDED</span>
              </div>
              <div class="community-activity-grid__grid-activity-content">
                <h3 class="govuk-heading-s"><%= activity.title %></h3>
                <p class="govuk-body-s activity-content"><%= activity.description.html_safe %></p>
                <%= link_to "Manage on Dashboard", @programme.path, class: "govuk-button ncce-button--white" %>
              </div>
            </div>
          <% end %>

          <% @activities.each do |activity| %>
            <div class="community-activity-grid__grid-activity">
              <div class="community-activity-grid__grid-activity-content">
                <h3 class="govuk-heading-s"><%= activity.title %></h3>
                <p class="govuk-body-s activity-content"><%= activity.description.html_safe %></p>
                <% if @enrolled && !@started_activities.any? %>
                  <a class="govuk-button ncce-button--white" role="button"
                    data-cms--community-activity-grid-component-target="activityButton"
                    data-cms--community-activity-grid-component-activity-title-param="<%= activity.title %>"
                    data-cms--community-activity-grid-component-activity-id-param="<%= activity.id %>"
                    data-action="cms--community-activity-grid-component#selectActivity">Choose Activity</a>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
<% end %>