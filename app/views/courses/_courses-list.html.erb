<div class='govuk-body-s ncce-courses__count'>Showing <%= pluralize(@course_filter.courses.size, 'result') %></div>
<% if @course_filter.courses.length == 0 %>
  <p class="govuk-body">No courses found that match your selection. Please try a different one.</p>
<% else %>
  <div class="ncce-courses__list" data-course-filter-target="loadingBar">
    <% @course_filter.courses.each do |course| %>
      <div class="ncce-courses__course">
        <h2 id="<%= course.title %>" class="govuk-heading-s ncce-courses__heading">
          <%= link_to course.title, course_path(id: course.activity_code, name: course.title.parameterize), class: 'ncce-link' %><span class="ncce-courses__heading-code"><%= course.activity_code %></span>
        </h2>
        <p class="govuk-body"><%= stripped_summary(course.meta_description) %></p>
        <% if course.occurrences.length > 1 %>
          <h3 class="govuk-body-s govuk-!-font-weight-bold ncce-courses__locations">
            <button aria-expanded="false">
            <svg aria-hidden="true" focusable="false" width="16px" height="10px" viewBox="0 0 160 100">
              <g transform="translate(80, 100) rotate(-135.000000)">
                  <rect width="100" height="27"></rect>
                  <rect width="27" height="100"></rect>
              </g>
            </svg>View dates & locations
            </button>
          </h3>
        <% end %>
        <% unless course.occurrences.empty? %>
          <ul class="govuk-list govuk-body-s ncce-courses__meta">
            <% course.occurrences.each do |oc| %>
              <li class="govuk-grid-row ncce-courses__meta-item">
                <span class="govuk-grid-column-one-half ncce-courses__meta-location <%= course_meta_icon_class(oc.online_cpd) %>">
                <%= oc.address_town %></span>
                <span class="govuk-grid-column-one-half ncce-courses__meta-date"><%= activity_times(oc.start_date, oc.end_date, oc.online_cpd) %></span>
              </li>
            <% end %>
          </ul>
        <% end %>
        <% unless course.subjects.nil? && course.key_stages.nil? && course.workstream.nil?%>
          <p class="govuk-body"><h3 class="screen-reader-only">Tags for this course:</h3>
            <% course.subjects.each do |subject| %>
              <% if @course_filter.subjects&.has_value?(subject.to_i) %>
                <strong class="govuk-tag ncce-courses__tag"><%= @course_filter.subjects.key(subject.to_i) %></strong>
              <% end %>
            <% end %>
            <% course.age_groups.each do |group| %>
                <% if @course_filter.age_groups&.has_value?(group.to_i) %>
                  <strong class="govuk-tag ncce-courses__tag"><%= @course_filter.age_groups.key(group.to_i) %></strong>
                <% end %>
            <% end %>
            <% course.programmes.each do |programme| %>
              <strong class="govuk-tag ncce-courses__tag"><%= programme %></strong>
            <% end %>
          </p>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %>
