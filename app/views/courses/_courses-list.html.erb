<div class='govuk-body-s ncce-courses__count' data-course-filter-target="resultsCount">Showing <%= pluralize(@course_filter.results_count, 'result') %></div>
<p><%=  @course_filter.location_search? %></p>

<div class="govuk-body-m ncce-courses__loading-bar hidden" data-course-filter-target="loadingBar">Loading...</div>


<% if @course_filter.results_count == 0 %>
  <div class='ncce-courses__no-results' data-course-filter-target="courseList">
    <% if @course_filter.current_hub.present? %>
      <p class="govuk-body">Sorry, this Computing Hub is currently not running any courses.</p>
      <p class="govuk-body">Please remove the Hub filter to see all our other courses.</p>
    <% else %>
      <%= image_pack_tag 'media/images/courses/sad-face.png', alt: 'Sad face', class: 'ncce-courses__sad-face' %>
      <p class="govuk-body">Sorry, we couldnâ€™t find any courses that match your filter options.</p>
      <p class="govuk-body">Try modifying or clearing the filter to see more results.</p>
    <% end %>
    <%= link_to 'Show all courses', courses_path(anchor: 'results-top'), class: 'govuk-button button ncce-courses__filter-button' %>
  </div>
<% else %>


  <div class="ncce-courses__list" data-course-filter-target="courseList">
    <% @course_filter.courses.each do |course| %>
      <div class="ncce-courses__course">
        <h2 id="<%= course.title %>" class="govuk-heading-s ncce-courses__heading">
          <%= link_to course.title, course_path(id: course.activity_code, name: course.title.parameterize), class: 'ncce-link' %><span class="ncce-courses__heading-code"><%= course.activity_code %></span>
        </h2>
        <p class="govuk-body"><%= stripped_summary(course.meta_description) %></p>
        <% if course.occurrences.length > 1 %>
          <h3 class="govuk-body-s govuk-!-font-weight-bold ncce-courses__locations">
            <button aria-expanded="false">
            <span class='ncce-courses__locations-type <%= course_meta_icon_class(course) %>'><%= course_type(course) %></span>
            <span class='ncce-courses__locations-name'>
              <%= view_course_phrase(course) %>
            </span>
            </button>
          </h3>
        <% end %>
        <% unless course.occurrences.empty? %>
          <ul class="govuk-list govuk-body-s ncce-courses__meta">
            <% course.occurrences.each do |oc| %>
              <li class="govuk-grid-row ncce-courses__meta-item">
                <span class="govuk-grid-column-one-half ncce-courses__meta-location <%= course_meta_icon_class(course) %>">
                  <%= occurrence_meta_location(oc) %></span>
                <span class="govuk-grid-column-one-half ncce-courses__meta-date"><%= activity_times(oc.start_date, oc.end_date, oc.online_cpd) %></span>
              </li>
            <% end %>
          </ul>
        <% end %>
        <% unless course.subjects.nil? && course.key_stages.nil? && course.workstream.nil?%>
          <p class="govuk-body"><h3 class="screen-reader-only">Tags for this course:</h3>
            <% course.subjects.each do |subject| %>
              <% if @course_filter.subjects&.has_value?(subject.to_i) %>
                <strong class="govuk-tag ncce-courses__tag"><%= @course_filter.subjects.key(subject.to_i) %></strong>
              <% end %>
            <% end %>
            <% course.age_groups.each do |group| %>
                <% if @course_filter.age_groups&.has_value?(group.to_i) %>
                  <strong class="govuk-tag ncce-courses__tag"><%= @course_filter.age_groups.key(group.to_i) %></strong>
                <% end %>
            <% end %>
            <% course.programmes.each do |programme| %>
              <strong class="govuk-tag ncce-courses__tag ncce-courses__tag ncce-courses__filter-tag--<%= programme.parameterize %>"><%= programme %></strong>
            <% end %>
          </p>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %>
